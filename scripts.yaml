water_warning:
  alias: High Water Warning
  sequence:
  - service: switch.turn_off
    entity_id: switch.washer
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: tts.google_translate_say
    entity_id:
        - media_player.dan_speaker
        - media_player.spare_room_speaker
        - media_player.guest_room_speaker
        - media_player.kitchen_speaker
        - media_player.office_home
        - media_player.kelly_home
        - media_player.smart_clock
    data:
      message: 'Warning! The lawndry sink water level is high! The washer has been turned off.'
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.toggle
    entity_id: switch.laundry_light
  - service: light.turn_on
    data:
      entity_id: group.living_room
      flash: long
  - service: switch.turn_on
    entity_id: switch.laundry_light

say_somthing:
  alias: Text-to-Speech Test
  sequence:
    - service: tts.cloud_say
      data:
        entity_id:
        - media_player.dan_speaker
        - media_player.spare_room_speaker
        - media_player.guest_room_speaker
        - media_player.kitchen_speaker
        - media_player.office_home
        - media_player.kelly_home
        - media_player.smart_clock
        message: 'Testing ... 1 ... 2 ... 3'
        language: en-IE
        options:
          gender: female
undercabinet_morning:
  alias: Activate morning settings
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.shellyrgbw2_1dfb87
        effect: 'Off'
    - service: light.turn_off
      data:
        entity_id: light.shellyrgbw2_1dfb87
    - service: scene.turn_on
      data:
        entity_id: scene.undercabinet_morning

undercabinet_evening:
  alias: Activate evening settings
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.shellyrgbw2_1dfb87
        effect: 'Off'
    - service: light.turn_off
      data:
        entity_id: light.shellyrgbw2_1dfb87
    - service: scene.turn_on
      data:
        entity_id: scene.undercabinet_evening

undercabinet_warm:
  alias: Activate warm settings
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.shellyrgbw2_1dfb87
        effect: 'Off'
    - service: light.turn_off
      data:
        entity_id: light.shellyrgbw2_1dfb87
    - service: scene.turn_on
      data:
        entity_id: scene.undercabinet_warm

undercabinet_cool:
  alias: Activate cool settings
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.shellyrgbw2_1dfb87
        effect: 'Off'
    - service: light.turn_off
      data:
        entity_id: light.shellyrgbw2_1dfb87
    - service: scene.turn_on
      data:
        entity_id: scene.undercabinet_cool

undercabinet_button:
  alias: Undercabinet Button Press
  sequence:
    - choose:
        # IF on bright scene
        - conditions:
            - condition: template
              value_template: "{{ states.light.shellyrgbw2_1dfb87.attributes.brightness == 255 }}"
          sequence:
            - choose:
                - conditions:
                    - condition: time
                      after: '06:00:00'
                      before: '20:00:00'
                  sequence:
                    - service: script.turn_on
                      data:
                        entity_id: script.undercabinet_morning
              default:
                - service: script.turn_on
                  data:
                    entity_id: script.undercabinet_evening
      # ELSE turn on bright scene
      default:
        - service: script.turn_on
          data:
            entity_id: script.undercabinet_cool

office_zoom:
  alias: Office Zoom
  sequence:
## Setup the lights just right
    - service: scene.turn_on
      data:
        entity_id: scene.office_zoom
## Pause the music
    - service: media_player.media_pause
      data:
        entity_id: media_player.office_home
##  Here is where we could close the blinds
##
##  Run the scene again in case the back lights came on with the door light switch
    - delay: "00:00:02"
    - service: scene.turn_on
      data:
        entity_id: scene.office_zoom

office_hacker:
  alias: Office Hacker
  sequence:
## Setup the lights just right
    - service: scene.turn_on
      data:
        entity_id: scene.office_hacker
##  Run the scene again in case the desk light turned off with the door light switch
    - delay: "00:00:01"
    - service: scene.turn_on
      data:
        entity_id: scene.office_hacker
    - service: cover.close_cover
      target:
        entity_id: cover.soma_ed_c1_c6_bb_2c_74

office_around_the_horn:
  sequence:
    - service: scene.turn_on
      data:
        entity_id: scene.office_off
    # - delay:
    #     milliseconds: 500
    - alias: the_loop
      repeat:
        count: 7
        sequence:
          - service: light.turn_on
            data:
              entity_id: light.office_desk_lamp
              brightness: 255
              transition: 0
          - delay:
              milliseconds: 250
          - service: light.turn_off
            data:
              entity_id: light.office_desk_lamp
              transition: 0
          - service: light.turn_on
            data:
              entity_id: light.office_window_light
              brightness: 255
              transition: 0
          - delay:
              milliseconds: 250
          - service: light.turn_off
            data:
              entity_id: light.office_window_light
              transition: 0
          - service: light.turn_on
            data:
              entity_id: light.office_chair_light
              brightness: 255
              transition: 0
          - delay:
              milliseconds: 250
          - service: light.turn_off
            data:
              entity_id: light.office_chair_light
              transition: 0
    # - service: light.turn_on
    #   data:
    #     entity_id: light.shellydimmer2_e8db84d4610a
    #     brightness: 255
    #     transition: 0
    # - delay:
    #     milliseconds: 250
    # - service: light.turn_off
    #   data:
    #     entity_id: light.shellydimmer2_e8db84d4610a
    #     transition: 0


notify_kelly:
  sequence:
    - choose:
        conditions:
        - condition: state
          entity_id: person.kelly_gentry
          state: 'home'
        sequence:
          - service: notify.living_room_cloud
            data:
              message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_24
                  state: 'spare'
                - condition: state
                  entity_id: sensor.espresence_apple_1006_10_8
                  state: 'spare'
              sequence:
                - service: notify.spare
                  data:
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_24
                  state: 'master'
                - condition: state
                  entity_id: sensor.espresence_apple_1006_10_8
                  state: 'master'
              sequence:
                - service: notify.master
                  data:
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_24
                  state: 'kitchen_dining'
                - condition: state
                  entity_id: sensor.espresence_apple_1006_10_8
                  state: 'kitchen_dining'
              sequence:
                - service: notify.kitchen
                  data:
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_24
                  state: 'office'
                - condition: state
                  entity_id: sensor.espresence_apple_1006_10_8
                  state: 'office'
              sequence:
                - service: notify.office
                  data:
                    message: '{{ message }}'
      default:
        - service: notify.signal_kelly
          data:
            message: '{{ message }}'

notify_dan:
  sequence:
    - choose:
        conditions:
        - condition: state
          entity_id: person.dan_gentry
          state: 'home'
        sequence:
          - service: notify.living_room
            data:
              message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_ibeacon_5887b4f1_5ec7_4db6_ad06_68f83af6609f_100_1
                  state: 'office'
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_12
                  state: 'office'
              sequence:
                - service: notify.office
                  data:
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_ibeacon_5887b4f1_5ec7_4db6_ad06_68f83af6609f_100_1
                  state: 'spare'
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_12
                  state: 'spare'
              sequence:
                - service: notify.spare
                  data:
                    title: '{{ title }}'
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_ibeacon_5887b4f1_5ec7_4db6_ad06_68f83af6609f_100_1
                  state: 'master'
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_12
                  state: 'master'
              sequence:
                - service: notify.master
                  data:
                    title: '{{ title }}'
                    message: '{{ message }}'
          - choose:
              conditions:
                condition: or
                conditions:
                - condition: state
                  entity_id: sensor.espresence_ibeacon_5887b4f1_5ec7_4db6_ad06_68f83af6609f_100_1
                  state: 'kitchen_dining'
                - condition: state
                  entity_id: sensor.espresence_apple_1005_9_12
                  state: 'kitchen_dining'
              sequence:
                - service: notify.kitchen
                  data:
                    title: '{{ title }}'
                    message: '{{ message }}'
      default:
        - service: notify.signal_dan
          data:
            message: '{{ message }}'

notify_both:
  sequence:
    - service: script.notify_dan
      data_template:
        message: "{{ message }}"
    - service: script.notify_kelly
      data_template:
        message: "{{ message }}"

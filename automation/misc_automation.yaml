# Send out MQTT messages

- alias: 'Publish Dark Sky Temperature'
  trigger:
    platform: state
    entity_id: sensor.dark_sky_temperature
  action:
    service: mqtt.publish
    data_template:
      payload: "{{states.sensor.dark_sky_temperature.state}}"
      topic: darksky/temperature/state
      retain: true

- alias: 'Publish defeat_sleep'
  trigger:
    platform: state
    entity_id: input_boolean.defeat_sleep
  action:
    service: mqtt.publish
    data_template:
      payload: "{{states.input_boolean.defeat_sleep.state}}"
      topic: hass/defeat_sleep/state
      retain: true

- alias: 'Publish outdoor_defeat_sleep'
  trigger:
    platform: state
    entity_id: input_boolean.outdoor_defeat_sleep
  action:
    service: mqtt.publish
    data_template:
      payload: "{{states.input_boolean.outdoor_defeat_sleep.state}}"
      topic: outdoor/defeat_sleep/state
      retain: true


- id: co2_warning
  alias: 'CO2 Level High'
  trigger:
    platform: numeric_state
    entity_id: sensor.air_quality_eco2
    above: 2000
    for:
      hours: 0
      minutes: 0
      seconds: 30
  action:
    service: notify.mobile_app_sm_g975u
    data_template:
      message: 'eCO2 level has exceeded 2,000 ppm'
      title: 'Bad Air'

- id: tvoc_warning
  alias: 'TVOC Level High'
  trigger:
    platform: numeric_state
    entity_id:  sensor.air_quality_tvoc
    above: 1000
    for:
      hours: 0
      minutes: 0
      seconds: 30
  action:
    service: notify.mobile_app_sm_g975u
    data_template:
      message: 'TVOC level has exceeded 1,000 ppb'
      title: 'Bad Air'

# - alias: 'Ranger contact'
#   trigger:
#     - platform: state
#       entity_id: binary_sensor.truck1
#       from: 'off'
#       to: 'on'
#   action:
#     - service: switch.turn_on
#       data:
#         entity_id: switch.kitchen_light

# - alias: 'Ranger out of contact'
#   trigger:
#     - platform: state
#       entity_id: binary_sensor.truck1
#       from: 'on'
#       to: 'off'
#   action:
#     - service: switch.turn_off
#       data:
#         entity_id: switch.kitchen_light

# - alias: Set office blinds slider
#   trigger:
#     platform: mqtt
#     topic: "of_blinds/tilt/position"
#   action:
#     service: input_number.set_value
#     data_template:
#       entity_id: input_number.office_blinds_slider
#       value: '{{ trigger.payload }}'

# - alias: Office blinds slider moved
#   trigger:
#     platform: state
#     entity_id: input_number.office_blinds_slider
#   action:
#     service: mqtt.publish
#     data_template:
#       topic: "of_blinds/tilt/control"
#       retain: true
#       payload: '{{ states.input_number.office_blinds_slider.state | int }}'

# - alias: 'Dark in here'
#   trigger:
#     - platform: numeric_state
#       entity_id: sensor.ambient_light_sensor
#       below: 0.5
#       for:
#         hours: 0
#         minutes: 0
#         seconds: 5
#   action:
#     - service: tts.google_translate_say
#       entity_id: media_player.office_home
#       data:
#         message: 'Boy, it sure is dark in here'

